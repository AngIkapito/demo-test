{% extends 'includes/base.html' %}
{% load static %}
{% block content %}

{% include 'includes/messages.html' %}
<div class="row">
    <div class="col-sm-12">
       <div class="card">
          <div class="card-body">
            
             <form method="post" action="{% url 'profile_update_hoo' %}" enctype="multipart/form-data">
                {% csrf_token %}
               
                <div class="col-12">
                     {% if user.user_type == '1' %}
                       <a href="{% url 'hoo_home' %}" class="btn btn-secondary" title="Go Back">
                           <i class="fas fa-arrow-left"></i>&nbsp;&nbsp; Back
                        </a>
                     {% elif user.user_type == '2' %}
                        <a href="{% url 'officer_home' %}" class="btn btn-secondary" title="Go Back">
                              <i class="fas fa-arrow-left"></i>&nbsp;&nbsp; Back
                           </a>
                     {% elif user.user_type == '3' %}
                           <a href="{% url 'member_home' %}" class="btn btn-secondary" title="Go Back">
                              <i class="fas fa-arrow-left"></i>&nbsp;&nbsp; Back
                           </a>
                     {% endif %}
                        <div class="text-center flex-grow-1">
                           <h1 class="h3 mb-0 text-gray-800"><span>Profile Update</span></h1>
                        </div>
                </div>

                <div class="col-sm-11">
                    <div class="form-group">
                        <label>Profile Picture</label>
                        <input type="file" class="form-control" name="profile_pic" id="profilePicInput" accept="image/*" onchange="previewImage(event)">
                        <div class="image-preview text-center" id="imagePreview" style="display: block;">
                          <img id="preview" src="{% if user.profile_pic %}{{ user.profile_pic.url }}{% else %}{% static 'img/default-profile.png' %}{% endif %}" alt="Image Preview" style="width: 192px; height: 192px; object-fit: cover; margin-top: 10px;border: 2px solid gray; border-radius: 4px;">
                      </div>
                    </div>
                </div>

                <div class="col-sm-11">
                   <div class="form-group">
                      <label>Firstname</label>
                      <input type="text" class="form-control" name="first_name" value="{{user.first_name}}" style="text-transform: uppercase;">
                   </div>
                </div>
                <div class="col-sm-11">
                   <div class="form-group">
                      <label>Lastname</label>
                      <input type="text" class="form-control" name="last_name" value="{{user.last_name}}" style="text-transform: uppercase;">
                   </div>
                </div>
                <div class="col-sm-11">
                    <div class="form-group">
                       <label>Email</label>
                       <input type="text" class="form-control" name="email" value="{{user.email}}" readonly >
                    </div>
                </div>
                <div class="col-sm-11">
                    <div class="form-group">
                       <label>Username</label>
                       <input type="text" class="form-control" name="username" value="{{user.username}}" readonly >
                    </div>
                </div>

                <div class="col-sm-11">
                     <div class="form-group">
                        <label>Change Password</label>
                        <input type="password" class="form-control" id="change_password" name="change_password" placeholder="Enter new password (leave blank to keep current)">
                     </div>
                </div>

                <div class="col-12">
                   <button type="submit" class="btn btn-primary">Update Profile</button>
                </div>
             </form>

          </div>
       </div>
    </div>
 </div>
</div>

<script>
   function previewImage(event) {
       const input = event.target;
       const preview = document.getElementById('preview');

       if (input.files && input.files[0]) {
           const reader = new FileReader();
           reader.onload = function(e) {
               preview.src = e.target.result;
           }
           reader.readAsDataURL(input.files[0]);
       } else {
           preview.src = "/static/img/default-profile.png";
       }
   }
</script>

{% endblock %}
